<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <title>Controlador Pasa Palabra</title>

    <style>
        body {
            gap: 20px;
            display: flex;
            color: #FFFFFF;
            font-family: Arial;
            align-items: center;
            flex-direction: column;
            justify-content: center;
            background-color: #0A2A43;
        }

        button {
            width: 400px;
            border: none;
            cursor: pointer;
            font-size: 22px;
            padding: 20px 40px;
            border-radius: 12px;
        }

        .title {
            margin-top: 75px
        }

        .start .continue {
            color: #000000;
            background-color: #FFFFFF;
        }

        .start:hover,
        .continue:hover {
            background-color: #DADADA;
        }

        .start:active,
        .continue:active {
            background-color: #C2C2C2;
        }

        .correct {
            color: #FFFFFF;
            background-color: #1FA84D;
        }

        .correct:hover {
            background-color: #1C9444;
        }

        .correct:active {
            background-color: #1B8B40;
        }

        .incorrect {
            color: #FFFFFF;
            background-color: #D54434;
        }

        .incorrect:hover {
            background-color: #BB3B2D;
        }

        .incorrect:active {
            background-color: #AA3628;
        }

        .pass {
            color: #FFFFFF;
            background-color: #1E80FF;
        }

        .pass:hover {
            background-color: #1A6FDF;
        }

        .pass:active {
            background-color: #1864C7;
        }

        .connection-status-in {
            margin: 0px;
        }

        .connection-status-out {
            top: -10px;
            margin: 0px;
            position: relative;
        }

        .game-status {
            width: 380px;
            font-size: 20px;
            font-weight: bold;
            text-align: center;
        }

        .score-board {
            margin: 0px;
            width: 380px;
            font-size: 16px;
            text-align: center;
        }
    </style>
</head>

<body>
    <h1 class="title">Controlador Pasa Palabra</h1>
    <p class="connection-status-in" id="connection-status-in">IN: En espera de entrada...</p>
    <p class="connection-status-out" id="connection-status-out">OUT: Conectando...</p>
    <button class="start" onclick="send('START')"><strong>Iniciar partida</strong></button>
    <button class="correct" onclick="send('CORRECT')"><strong>Correcto</strong></button>
    <button class="incorrect" onclick="send('INCORRECT')"><strong>Incorrecto</strong></button>
    <button class="pass" onclick="send('PASS')"><strong>Pasa Palabra</strong></button>
    <button class="continue" onclick="send('CONTINUE')"><strong>Continuar</strong></button>
    <p class="game-status" id="game-status"></p>
    <p class="score-board" id="score-board-player1"></p>
    <p class="score-board" id="score-board-player2"></p>

    <script>
        const player1Clues = new Map([
            ["A", "Con la A: Segundo nombre tan bueno que, objetivamente, el resto juega en otra liga.<br><br>Respuesta: Alberto"],
            ["B", "Con la B: Tan inofensivo era el certificado que solo un sistema se dio cuenta de él. Demasiado.<br><br>Respuesta: BPM"],
            ["C", "Con la C: Marca de tabaco con la que te fastidias los pulmones, pero solo en ocasiones especiales.<br><br>Respuesta: Camel"],
            ["D", "Con la D: Es el mismo juego que el teto, pero sin fin.<br><br>Respuesta: Delfin"],
            ["E", "Con la E: Medio de comunicación/herramienta que utilizas para hacernos llegar las comunicaciones del comité.<br><br>Respuesta: Email"],
            ["F", "Con la F: Cual es tu postura cuando en un debate no quieres dar la razón ni aunque te paguen.<br><br>Respuesta: Firme"],
            ["G", "Con la G: Personaje de La Rueda del Tiempo, medio hermano de Gawyn y Elayne.<br><br>Respuesta: Galad"],
            ["H", "Contiene la H: Héroe legendario del Mundodisco, parodia y homenaje de Conan el Bárbaro.<br><br>Respuesta: Cohen el Bárbaro"],
            ["I", "Con la I: Coloquialmente, el apodo con el que has bendecido a Elena Subias.<br><br>Respuesta: I****l"],
            ["J", "Con la J: Cris es tu...<br><br>Respuesta: Jefa"],
            ["K", "Contiene la K: Palabra que se dice cuando, tras 3 debates, 2 cafés, 1 discusión absurda y 24 commits, Carlos vuelve a tener razón y Jose dice “vale”, y el programa de presupuestos, expedientes, pedidos y facturas sigue vivo.<br><br>Respuesta: Eureka"],
            ["L", "Contiene la L: Tu grupo de música favorito.<br><br>Respuesta: Metallica"],
            ["M", "Con la M: Tu género de música favorito.<br><br>Respuesta: Metal"],
            ["N", "Con la N: Estado en el que se encuentra un objeto no inicializado o una variable que aún no contiene ningún valor.<br><br>Respuesta: Null"],
            ["Ñ", "Contiene la Ñ: Apellido del director cincuentón más atractivo de IL3.<br><br>Respuesta: Madueño"],
            ["O", "Contiene la O: Mes en el que cumple años Eric.<br><br>Respuesta: Febrero"],
            ["P", "Con la P: ¿Qué aspecto físico dirías que destaca más de ti? Iba a decir otra cosa, pero como no la he visto... es algo que tienes en la cabeza.<br><br>Respuesta: Pelo o Pelazo"],
            ["Q", "Con la Q: Si en el comité hay un conflicto y no se logra un acuerdo, ¿qué trámite entra en acción?<br><br>Respuesta: Querella"],
            ["R", "Con la R: Nombre del grupo de música que se inspira en el accidente ocurrido en una base aérea.<br><br>Respuesta: Ramstein"],
            ["S", "Con la S: Videojuego en que más dinero has invertido y aun así no te parece suficiente.<br><br>Respuesta: Star Citizen"],
            ["T", "Con la T: Forma de viajar instantáneamente sin coche, sin tráfico y sin saber si llegas con todas tus moléculas.<br><br>Respuesta: Teletransportarse/Teletransporte"],
            ["U", "Con la U: Lugar enorme donde las naves espaciales no usan intermitentes, los Jedi se pierden sin GPS y todo explota tarde o temprano.<br><br>Respuesta: Universo"],
            ["V", "Con la V: Grupo de danza y música español, formado por siete hermanos que revolucionaron el flamenco fusión y coincidente con el apellido de un compañero de trabajo.<br><br>Respuesta: Vivancos"],
            ["W", "Con la W: Completa la frase de una popular pelicula española. Me debes 3000 pesetas de...<br><br>Respuesta: Whisky"],
            ["X", "Con la X: Caza de combate letal del universo Star Wars.<br><br>Respuesta: X-Wing"],
            ["Y", "Con la Y: Término coloquial para describir algo que da mal rollo o miedo.<br><br>Respuesta: Yuyu"],
            ["Z", "Contiene la Z: Espacio musical epicentro de algunos de los acontecimientos musicales más relevantes de Barcelona situado en el Poblenou y que seguro que has ido muchas veces.<br><br>Respuesta: Razzmatazz"]
        ]);
        const player2Clues = new Map([
            ["A", "Con la A: Empresa tan maravillosa que, bajo ningún concepto, existe un plan de cambiarla antes del 31 de enero.<br><br>Respuesta: Alisys"],
            ["B", "Contiene la B: Forma parte del equipo TIC, ronda el medio siglo como tú, ojos azules hipnóticos y, desde mi objetivísimo punto de vista... peligrosamente sexy.<br><br>Respuesta: Gabriel"],
            ["C", "Con la C: Zumbado con el que montaste un ciber antes de que Emil ni tan si quiera fuera una vaga idea en la mente de sus padres.<br><br>Respuesta: Carlos"],
            ["D", "Con la D: Clásico juego de rol de mesa, publicado por primera vez en los años 70, con ambientación de fantasía.<br><br>Respuesta: Dungeons & Dragons"],
            ["E", "Con la E: Grito que aparece tras horas de discutir sobre presupuestos, expedientes, pedidos y facturas, justo cuando Carlos tenía razón, Jose se la da, y el programa por fin funciona después de dos años.<br><br>Respuesta: Eureka"],
            ["F", "Con la F: La emoción que sientes al ver a tu hija cada día.<br><br>Respuesta: Felicidad"],
            ["G", "Con la G: Mago legendario de “El Señor de los Anillos”, conocido como “el Gris” y miembro de la Comunidad del Anillo.<br><br>Respuesta: Gandalf"],
            ["H", "Con la H: Arte mágico de la saga “Nacidos de la Bruma” que permite robar y transferir habilidades mediante clavos metálicos.<br><br>Respuesta: Hemalurgia"],
            ["I", "Contiene la I: Nombre completo de tu técnica favorita que emprendió un nuevo camino en abril del 2025.<br><br>Respuesta: Cristina"],
            ["J", "Con la J: Nombre completo del miembro de tu equipo que se incorporó en diciembre del 2016.<br><br>Respuesta: Jose Maria Muñoz"],
            ["K", "Con la K: Tejido de altísima resistencia usado como refuerzo en palas de padel y otros elementos, aportando gran rigidez.<br><br>Respuesta: Kevlar"],
            ["L", "Con la L: Proyecto que empezó Vanesa, acabó Laura, impactó a Oriol y a Santo Cristo y aun sigue con nosotros como puerta de entrada a nuestros cursos.<br><br>Respuesta: Lobby"],
            ["M", "Contiene la M: Serie muy famosa ambientado en el universo Star Wars.<br><br>Respuesta: The Mandalorian"],
            ["N", "Con la N: Partícula subatómica sin carga eléctrica que reside en el núcleo de los átomos.<br><br>Respuesta: Neutrón"],
            ["Ñ", "NO contiene la Ñ: Tu juego de mesa preferido donde no se conoce el miedo.<br><br>Respuesta: Forbidden Stars"],
            ["O", "Contiene la O: Juego de mesa de los años 80 donde un bárbaro, un enano, un elfo y un mago, intentan derrotar al malvado Zargon en un conjunto de mazmorras.<br><br>Respuesta: HeroQuest"],
            ["P", "Con la P: Cuál es el deporte considerado de personas mayores y que ahora está de moda.<br><br>Respuesta: Padel"],
            ["Q", "Contiene la Q: Con qué herramienta te diste en la cabeza practicando tu deporte favorito de personas mayores, probablemente gracias a tu competitividad.<br><br>Respuesta: Raqueta"],
            ["R", "Con la R: Nombre en inglés de una montaña rusa interior con fuego real, presente en el parque de atracciones de Orlando.<br><br>Respuesta: Revenge of the Mummy"],
            ["S", "Con la S: Compañero de pádel de Martín mu malo.<br><br>Respuesta: Sergio"],
            ["T", "Con la T: Algo que te gusta mucho ordenar a tus empleados.<br><br>Respuesta: Tarea/Trabajo"],
            ["U", "Con la U: Lugar donde estudiabas cuando todavía tenías pelo.<br><br>Respuesta: Universidad"],
            ["V", "Con la V: Nombre de persona claramente reventado de la cabeza con el que trabajaste hace tiempo.<br><br>Respuesta: Victor"],
            ["W", "Con la W: Nombre de centro comercial donde Rubén te puede acompañar en coche siempre que quieras.<br><br>Respuesta: Westfield La Maquinista"],
            ["X", "Contiene la X: Proceso para determinar el valor de una incógnita en una ecuación matemática utilizando el resto de valores presentes en la misma.<br><br>Respuesta: Despejar la X"],
            ["Y", "Con la Y: Apellido de excompañera de trabajo apreciada por todos y que está muy concienciada e implicada con el medio ambiente y el cambio climático.<br><br>Respuesta: Yábar"],
            ["Z", "Contiene la Z: Apellido de uno de los integrantes más jóvenes de tu equipo.<br><br>Respuesta: Rodriguez (Adrian)"]
        ]);
    </script>

    <script src="https://unpkg.com/peerjs@1.5.5/dist/peerjs.min.js"></script>

    <script>
        const connectionStatusIN = document.getElementById("connection-status-in");
        const connectionStatusOUT = document.getElementById("connection-status-out");
        const gameStatus = document.getElementById("game-status");
        const scoreBoardPlayer1 = document.getElementById("score-board-player1");
        const scoreBoardPlayer2 = document.getElementById("score-board-player2");

        const peerIN = new Peer("898998c9-d56f-411c-a962-2d83af0a1006", {
            debug: 0
        });

        const peerOUT = new Peer();

        let connection = null;
        let started = false;
        let finished = false;

        peerOUT.on("open", () => {
            connection = peerOUT.connect("68c26dca-d0ea-4a98-a61d-0ef46e5d8ad8");
            connection.on("open", () => {
                console.log("OUT: Connection established");
                connectionStatusOUT.textContent = "OUT: Conexión establecida";

                peerIN.on("open", id => {
                    console.log("Connection ID:", id, "(IN)");
                    connectionStatusIN.textContent = "IN: Esperando conexión...";
                });

                peerIN.on("connection", connection => {
                    console.log("IN: Connection established");
                    connectionStatusIN.textContent = "IN: Conexión establecida";
                    connection.on("data", data => {
                        handleRemoteCommand(data);
                    });
                });
            });
        });

        function handleRemoteCommand(command) {
            if (command === "Partida finalizada") {
                if (!finished) {
                    finished = true;
                } else {
                    return;
                }
            }
            const parts = command.split(",");
            if (parts[0] === "CLUE") {
                let clue;
                if (parts[1] === "Carlos") {
                    clue = player1Clues.get(parts[2]);
                } else if (parts[1] === "Martin") {
                    clue = player2Clues.get(parts[2]);
                } else {
                    clue = "Player not found"
                }
                gameStatus.innerHTML = "<h3 style='margin: 0px;'>" + parts[1] + "</h3><br>" + clue;
            } else if (parts[0] === "SCORE") {
                scoreBoardPlayer1.textContent = parts[1];
                scoreBoardPlayer2.textContent = parts[2];
            } else {
                gameStatus.textContent = command;
            }
        }

        function send(command) {
            if (connection && connection.open) {
                if (command === "START") {
                    if (!started) {
                        started = true;
                    } else {
                        return;
                    }
                }
                connection.send(command);
            }
        }
    </script>

</body>

</html>